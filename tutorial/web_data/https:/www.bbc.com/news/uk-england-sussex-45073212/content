Draped in a rainbow flag and blowing kisses, Britney Spears wowed a crowd of 57,000 at Brighton Pride.
The superstar headlined the opening day of the festival, kicking off a European tour of her Las Vegas show Piece of Me.
Afterwards, she tweeted: "Thank you for a fabulous show...my fabulous fans. I love you all."
But thousands of fans were stranded in the early hours of Sunday after chaotic scenes at the city's railway station.
Police requested that the station was closed and train services suspended shortly before midnight to help them deal with growing crowds.
Govia Thameslink Railway (GTR) said the station later "steadily cleared" with the last extra train leaving at 02:15 BST.
Brighton and Hove Pride said it was "very disappointed that GTR were unable to provide sufficient services to people returning home".
It said people safely left Preston Park "in less than 30 minutes" but "their safety was put in jeopardy by GTR and the station's failure to plan for adequate train services".
A GTR spokesperson said: "We ran 15 extra trains yesterday to cope with the unprecedented visitor numbers, in addition to the plan we had agreed with the event organisers.
"Access to Brighton station was closed for a period by the police to help with crowding in the town, after which our extra trains helped clear the station steadily." 
It said it would be talking to Pride organisers and police about whether it needed to enhance Sunday's timetable.
Britney returns to the UK in two weeks for shows in Scarborough, Manchester, Glasgow and London.
Dressed in a sequinned leotard, she treated the Brighton crowd to classics including Baby One More Time, Oops!... I Did It Again and Toxic.
Just as in her Las Vegas residency - which ran on and off for four years from December 2013 - the audience was given a performance of slick routines, with around 20 backing dancers, and countless costume changes.
Her other numbers included Boys, Me Against The Music, Piece of Me, Gimme More and Womanizer.
The 90-minute set, which ended with her dancing with a rainbow flag, also found room for a tribute to songs by rapper Missy Elliott.
Earlier in the day, people tweeted about the chaotic scenes at London's St Pancras Station as they queued for up to 30 minutes to buy their train tickets to Brighton.
Carl Smith, who was caught up in the chaos after Brighton railway station was closed at midnight, said: "There was just loads of crushing. There were people passing out - there was no water.
"Trains had been going but with no-one on them. Our friend managed to get through the barrier somehow. He texted me and said 'I'm on an empty train going back to London. Why are there still thousands of people outside?'."
Jo Squire, from Worthing, said she arrived at the station at 22:45 to find the station gates closed.
She said: "People were getting crushed and the police were everywhere. I was continually thinking about how we could get out of the massive crowd. It was really scary to feel stuck like that."
Stephania Darius, 34, from London, gave up and paid Â£250 for a taxi home.
She said: "There was no information at all given to the crowd about what was happening. The police weren't able to give me any information, and the guards just ignored us. 
"Because of the big crowds, my phone wasn't working, so I was just stood there not knowing what was happening."
Others caught up in the disruption have tweeted their experiences.
Brighton and Hove City Council said some people who decided not to travel "went to the beach instead".
"The numbers were added to by others leaving the Pride Village Party and also heading to the seafront. This led to overcrowding in some areas and an increase in calls to emergency services," a spokesperson said.
