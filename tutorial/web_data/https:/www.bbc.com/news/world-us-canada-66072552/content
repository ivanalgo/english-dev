A messy effort to equip planes with updated technology is threatening to upend possibly the busiest weekend for post-pandemic air travel in the US.
Airlines have been racing to retrofit their fleets with new gear before Saturday, when US wireless carriers will begin to boost their 5G signals.
But many domestic and international carriers cannot meet the deadline, the Federal Aviation Administration says.
Holiday-goers may also see their schedules upended by extreme weather.
Severe storms along the country's east coast, a heat wave baking southern states, and Canadian wildfire smoke have each contributed to difficult conditions for air travel this week.
More than 6,000 flights have been scrapped and over 30,000 delayed since Monday, based on data from the FlightAware website.
Even as most airlines have since largely rebounded, the days ahead will see wildfire smoke waft over busy airspaces like New York and thunderstorms roil Midwestern states.
Thursday marked the busiest day for American air travel since before the pandemic with more than 52,000 flights, the FAA said on Twitter.
That  volume may be topped on Friday, the start of the Independence Day long weekend, with an estimated 2.8 million people expected to travel that day, according to the Transportation Security Administration. Several million more could travel over the weekend through into Tuesday. 
The surge of passengers comes as hundreds of planes will fail to meet the deadline for government-mandated updates to their landing systems.
Starting on Saturday, AT&T, Verizon and other wireless network operators will be free to increase the power of their 5G signals, a change that may lead to better cellular performance in and around airports.
But airline industry officials have warned the changes could interfere with the radio frequency filters planes use to help pilots determine altitude. Known as radio altimeters or radar altimeters, the equipment is particularly important for landing safely in inclement or low-visibility conditions.
In line with these concerns, the FAA directed all carriers to upgrade their fleets with new 5G-tolerant altimeters by Saturday. But it said in a statement to the BBC that the new technology is yet to be installed in about 15% of domestic planes and 34% of international planes that fly in US airspace.
Last week, Transportation Secretary Pete Buttigieg warned airlines in a letter: "Only aircraft with retrofitted radio altimeters will be able to perform low-visibility landings. And for certain fleet types, a retrofit will be necessary to operate at all in the United States after the deadline."
According to the FAA, carriers in Europe, including the UK, have "largely completed their work".
But trade groups representing US airlines complain that global supply chain issues have hindered their efforts to be compliant.
"Carriers have repeatedly communicated this reality to the government," Airlines for America, which represents most major US carriers, said.
"Nevertheless, thanks to careful planning, A4A member carriers are confident in their ability to maintain the integrity of their schedules, despite the impending deadline."
American, Alaska, Southwest and United - all A4A members - confirmed to US media this week that they will be able to meet the deadline.
But another key carrier, Delta, said that about 190 aircraft from its fleet of over 900 will not be upgraded in time due to a supplier issue.
"What this means for Delta is that some of our aircraft will have more restrictions for operations in inclement weather," a spokesperson said, adding that some operational impact should be expected.
"Safety of flight will never be in question, and Delta will adhere to all directives and regulations from our regulators,"
