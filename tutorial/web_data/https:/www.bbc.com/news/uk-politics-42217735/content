The UK and EU have failed to reach an agreement to move to the next stage of Brexit talks, Theresa May has said.
The prime minister said talks would reconvene "before the end of the week" and she was "confident we will conclude this positively".
The talks are understood to have broken down after the Democratic Unionist Party refused to accept concessions on the Irish border issue.
Downing Street said that was not the only outstanding problem.
Irish Prime Minister Leo Varadkar said a deal had been done, but the UK appeared to change its mind over the Irish border question after pressure from the DUP.
"I am surprised and disappointed that the British government now appears not to be in a position to conclude what was agreed earlier today," he told a press conference in Dublin.
BBC political editor Laura Kuenssberg said: "Is it a complete disaster? No. Does it mean this whole process is totally doomed? No, it does not. Is it a pretty significant disappointment? Yes, it is.
"Officially, the line out of government tonight is that Number 10 was not taking a deal for granted... but a government source has actually told me that as recently as this morning the prime minister was told that the DUP had been squared off." 
Northern Ireland's DUP has 10 MPs at Westminster, and their support is vital to the government.
This is because the Conservatives are without a Commons majority since June's general election, and rely on a deal with the DUP to ensure they can survive key votes.
How the talks broke down
Mrs May is understood to have broken off from talks with European Commission President Jean-Claude Junker to speak to DUP leader Arlene Foster.
The UK had reportedly been prepared to accept that Northern Ireland may remain in the EU's customs union and single market in all but name.
But Mrs Foster then said her party "will not accept any form of regulatory divergence" that separates Northern Ireland from the rest of the UK.
"During the call it was made plain to the PM that the DUP had significant concerns about the deal being discussed that gave concessions to the Dublin government," said the BBC's political editor Laura Kuenssberg. 
"I understand Mrs Foster told Theresa May that she would not be able to support such a deal. 
"It's been suggested too that there are 20 or so Conservative MPs who had serious misgivings about the compromises that were understood to be on the table."
DUP leader Arlene Foster said her party would not accept any Brexit deal that "separates" Northern Ireland from the rest of the UK.
Her party's Brexit spokesman Sammy Wilson claimed Brussels has been trying to "bounce the prime minister into acceding to the shape of a deal they want" and many of her own backbenchers would not accept it.  
He said the DUP objected to the form of words used in a draft document, which he said referred to "regulatory alignment" and "no regulatory divergence" between Northern Ireland and the EU.
Both phrases were "simply EU speak for keeping Northern Ireland in the European market" and "in effect, part of the United Kingdom would be kept within the single market," he said.
Asked if the DUP would pull out of the confidence and supply agreement they have with the Conservative government in Westminster over this issue, he said: "I think that her (Theresa May) problem isn't going to be just with the DUP".
Leo Varadkar says he wants a written guarantee that there will be no return to a "hard border" between the Republic and Northern Ireland - and this is what he thought he had got.
"I am surprised and disappointed that the British government now appears not to be in a position to conclude what was agreed earlier today," he said.
"I accept that the prime minister has asked for more time and I know that she faces many challenges, and I acknowledge that she is negotiating in good faith. 
"But my position and that of the Irish government is unequivocal: Ireland wants to proceed to phase two. 
"However, we cannot agree to do this unless we have firm guarantees that there will not be a hard border in Ireland under any circumstances."
He said it was important to listen to the DUP, but also to bear in mind the position of other parties in Northern Ireland - and it should not be forgotten that the majority in Northern Ireland voted to remain in the EU.
Speaking at a joint press conference in Brussels with Mr Juncker, Mrs May said: "We have been negotiating hard. And a lot of progress has been made. And on many of the issues there is a common understanding.
"And it is clear, crucially, that we want to move forward together. 
"But on a couple of issues some differences do remain which require further negotiation and consultation."
The European Commission President said "it was not possible to reach complete agreement today" despite their "best efforts".
But he added: "I have to say that we were narrowing our positions to a huge extent today, thanks to the British prime minister, thanks to the willingness of the European Commission to have a fair deal with Britain.
"I'm still confident that we can reach sufficient progress before the European Council of 15 December.
"This is not a failure, this is the start of the very last round. 
"I'm very confident that we will reach an agreement in the course of this week."
Labour leader Jeremy Corbyn said: "The real reason for today's failure is the grubby deal the government did with the DUP after the election."
He added that "Labour has been clear from the outset that we need a jobs-first Brexit deal that works for the whole of the United Kingdom".
Conservative MPs emerging from a Downing Street briefing on the talks said they had been told Mrs May had not agreed the proposal on regulatory alignment put forward by the Irish government.
Leading Brexiteer Jacob Rees-Mogg said that the Conservatives were "as one" with the DUP on the importance of keeping the United Kingdom together, and the mood among Tory MPs in the meeting was "contented, not divisive or unhappy".
Backbench Remain supporter Anna Soubry said no Conservative MP wanted Northern Ireland treated differently from the rest of the UK, which she said would be "a gift" to the Scottish National Party. 
The "simple solution" would be for the whole of the UK to remain in the single market and customs union, she added.
Lib Dem Brexit spokesman Tom Brake said: "As each day goes by, it becomes clearer that the best deal for everyone is to stay in Europe. The people of the UK must be given a vote on the deal and an opportunity to exit from Brexit."
Scottish First Minister Nicola Sturgeon said that if Northern Ireland was allowed to operate under different rules there was "surely no good practical reason" why other parts of the UK could not do the same - a message echoed by Welsh First Minister Carwyn Jones and London Mayor Sadiq Khan.
The EU says it will only recommend the start of talks about future trade arrangements when it deems "sufficient progress" has been made on three issues - the status of expat citizens, the "divorce" bill and the Northern Ireland border.
The UK has been set a deadline of this week to come forward with an improved offer on them, and hopes that the go-ahead for future talks will then be given at an EU leaders' summit on 14-15 December.
On the "divorce bill", the UK is understood to have recently increased its offer, which could be worth up to 50bn euros (Â£44bn). 
On the issue of rights for the three million EU citizens in Britain, the UK has agreed that those who already have permanent residence will not have to pay to apply for settled status. 
Those making a first time application for the right to stay after Brexit, however, will face a charge - reportedly similar to the cost of applying for a passport.
Settled status will grant those who have spent five years in the UK equal rights on healthcare, education, benefits and pensions to British citizens.
Ministers have already suggested people legally resident in the UK before an as yet unspecified cut-off date will be allowed to stay and they want to make the process "as easy as renewing a driving licence".
