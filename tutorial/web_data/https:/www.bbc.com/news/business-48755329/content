Southern Water has been hit with a record £126m punishment for spills of wastewater into the environment from its sewage plants and for deliberately misreporting its performance.
The penalty will see customers get a rebate of at least £61 each.
"What we found in this case is shocking," said Rachel Fletcher, the head of water regulator Ofwat, while Southern said it was "deeply sorry".
The Environment Agency has launched a criminal investigation into the case.
The Agency has the power to take court action if companies' actions hurt the natural environment.
"We are pursuing our own criminal investigation into Southern Water due to suspected permit breaches at a number of its sites," the EA said in a statement. 
It added that it expected to start court proceedings "soon".
Under the agreement with Ofwat, each customer will receive at least £17 in 2021 and at least £11 per year for the following four years.
Southern will pay a total of £123m to customers, as well as a fine of £3m.
Ofwat said that proportionate to the size of the business, the penalty for the failings - which took place between 2010 and 2017 - was the biggest it has ever imposed.
It added the total would have been bigger if Southern had not co-operated with its investigation and addressed its errors.
Southern's failings included not making the necessary investment, which led to equipment failures, and spills of wastewater.
Ofwat also found the company manipulated its wastewater sampling process, which meant it misreported information about the performance of a number of sewage treatment sites.
As a result of the misreporting, it avoided penalties under Ofwat's incentive regime. 
However, £91m of the £123m it is now having to pay to customers makes up for this.
Ofwat would not say where the spillages took place.
Southern operates in the south-east of England, serving customers in Kent, Sussex, Hampshire and the Isle of Wight.
It has over 300 wastewater treatment sites and Ofwat said a "significant number" of these had had been affected by problems.
It is not the first time Southern has been punished for misreporting information about its performance.
In 2007, Ofwat fined the company £20.3m after its actions meant it could raise its prices by more than it should have done.
Ms Fletcher said the findings showed "the company was being run with scant regard for its responsibilities to society and the environment".
"It was not just the poor operational performance, but the co-ordinated efforts to hide and deceive customers of the fact that are so troubling," she added.
"The previous management failed to stamp out this behaviour and failed to manage its plants properly. In doing so, Southern Water let down its customers and operated in a way completely counter to the public service ethos we expect." 
Southern Water's current chief executive, Ian McAulay, who was appointed in 2017, said: "There are no excuses for the failings that occurred.
"We have clearly fallen far short of the expectations and trust placed in us by our wastewater customers and the wider communities we serve.
"We are fully committed to the fast pace of change delivered since 2017. There is a lot more work to do but we're pleased that this proposal agreed with Ofwat enables us to fully make amends to our customers and regain their trust as quickly as possible."
Southern Water is owned by Greensands Investments Limited, a consortium of pension and infrastructure funds which came together in 2007. 
