Many of the UK's largest shopping chains have reported Christmas sales and it's a very mixed picture.
While the trade body for shops, the British Retail Consortium, said it's been the worst Christmas for retailers in 10 years, some shops have had a relatively good festive period.
"Retail is facing the most disruption it's ever faced," says Alan O'Neill, who was hired at Selfridges as a consultant when it was bought by the Weston family in 2003.
So whose tills overflowed with Christmas cheer and whose takings resembled an empty stocking?
The sales figures in the graphic above cover different reporting periods as the companies follow no convention on what constitutes the Christmas season.
Contrary to the usual theme of mid-market stores being squeezed, Tesco and Morrisons both posted increases in sales. Both were helped out by sales outside their superstores. 
Morrisons said sales rose 3.6% in the nine weeks to 6 January. A 3% rise in the wholesale division, which supplies Amazon and McColls, assisted its growth. In the stores, sales rose 0.6%
Tesco, Britain's biggest retailer, beat forecasts with a 2.2% rise in comparable sales for the six weeks to 5 January. That beat City estimates of up to 1.5%.
"It looks like Christmas delivered the goods for Tesco," says Sophie Lund-Yates, equity analyst at Hargreaves Lansdown. "Of course, the coast isn't totally clear - Aldi and Lidl are moving in on market share."
However, Tesco and Morrisons may merely have "bounced back" from the ground lost last year, which was particularly hard on the superstores, warns retail consultant Clare Bailey.
German discount supermarket chain Aldi said it made almost £1bn in sales during December in its best-ever Christmas trading, with sales 10% higher than the previous year. Lidl sales jumped 8%.
According to data from market researchers Kantar, Aldi and Lidl had a combined market share of 12.7% over the 12-week festive period, their highest-ever for Christmas.
Two-thirds of all households shopped at either Aldi or Lidl over that time, Kantar said.
Selfridges reported sales up 8% in the first 24 days of December. 
The department store said it helped draw customers through various entertainments including a Christmas cabaret, confetti cannons, visits from Father Christmas and choirs. A five-year £300m refit of its flagship London store is also under way.
The two department stores, with more than 300 years of history between them, had a tough Christmas. Debenhams, which is shutting 50 stores, said sales in the six weeks to 5 Jan dropped 3.4%. Customers were in a bargain-hunting mood, it said. Over the longer 18-week trading period, sales fell 5.7%.
Mild weather and promotions were blamed by Marks & Spencer for a sales drop of 2.2% in the 13 weeks to 29 December. Food sales fell 2.1% and its clothing and home sales division slid 2.4%. 
"Their proposition is just no longer relevant to their audience," says Bill Grimsey, former chief executive of Wickes, Iceland and Focus DIY, and author of two reviews of the High Street. "For Marks & Spencer, Next is doing a better job and in Debenhams' case the 1980s aren't here today."
Discounting products "isn't working" for either store, he adds.
Mothercare blamed a "difficult consumer backdrop" for a fall in sales in the UK in its last quarter. Sales fell 11.4% and online sales dropped more, by 16.3%, the firm said on Wednesday. It has discounted less of its stock this year, it added. 
The business is closing 36 stores and by the end of March, there will be 79 stores, down from 137 in May 2018.
Sainsbury's has seen sales fall over Christmas after non-food trading was hit.
Sales, excluding takings from stores open less than a year, fell by 1.1% across the Christmas period.
General merchandise sales, including at Sainsbury's-owned Argos, fell by 2.3% and overall clothing sales by 0.2%.
There was speculation that Argos could have benefited from the demise of Toys R Us, which collapsed last year. But this boost didn't materialise, says retail consultant Clare Bailey, which could be down to changing trends in toy buying, including demand for tech-based presents.
Halfords issued a profit warning after sales at established stores fell 1.7% for the 14 weeks to 4 January.
The car and bike parts shop blamed mild winter weather in November and December, as motoring-related sales led the decline, dropping 3.4%.
It is perhaps a glib move to include the music retailer, but HMV was among the more severe losers after calling in administrators for the second time in six years, involving 2,200 staff at 125 stores.
Owners Hilco, which took the company out of its first administration in 2013, blamed a "tsunami" of retail challenges.
Shops doing poorly are probably led by complacent management who "don't take the risks they need to take", says Alan O'Neill, the former Selfridges consultant. 
His advice for them is to cut excess shopping space, negotiate with landlords, expand online rather than admitting defeat to online-only stores like Asos, and to stop discounting as a promotional tool. Instead, make use of January sales to shift old stock.
Shops doing well are taking risks with clever campaigns and spending money on high-quality stores, products and service.
Cutting costs from staff to product quality is also hurting retail sales and ultimately profit, says retail industry consultant Richard Hyman.
"It's not difficult to cut costs in a business," he said, but it is hard to do it without shrinking sales.
Regular business-watchers will have noted that these updates are for sales only - no mention of profit. And that they are published very quickly after the event.
"The fact that these numbers are unaudited and unregulated, and so much store is set by them, is a disconnect," says Mr Hyman. "We need these numbers to be regulated and to be audited. 
"The real proof of the pudding will be in April," he told the BBC, when audited results will be available, and, crucially, profit numbers, which will show what effect discounts will have had. 
